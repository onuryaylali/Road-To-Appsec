# February 3, 2026: Malware Analysis Pipeline - Sysmon, MITRE & AI Insights

## 1. Kernel-Level Monitoring with Sysmon
I integrated **Microsoft Sysmon** into my sandbox to achieve deep visibility into system-level events that traditional user-mode monitors miss.

* **Process Dynamics:** * Monitoring `ProcessCreation` and `ProcessAccess` to detect code injection and hollowing.
    * Identifying parent-child process relationships to spot suspicious execution chains.
* **Network Visibility:** * Capturing EID 3 (Network Connection) to log Command & Control (C2) communication attempts.
    * Tracking DNS queries to identify Domain Generation Algorithms (DGA).



## 2. Intelligence Mapping & Scoring Engine
I developed a logic layer to transform raw logs into actionable security intelligence.

### Behavioral Scoring
The engine evaluates activity based on predefined risk patterns:
* **Registry Persistence:** High-priority score for modifications in `Run` or `RunOnce` keys.
* **API Hooking:** Detection of suspicious Win32 API calls (e.g., `CreateRemoteThread`, `WriteProcessMemory`).

### MITRE ATT&CK Alignment
Every high-score activity is automatically mapped to the industry-standard **MITRE ATT&CK** framework for better categorization.
* **Example:** Detecting a remote thread creation triggers a mapping to **T1055 (Process Injection)**.



## 3. Google Gemini AI Insights Integration
To manage the complexity of massive JSON reports, I integrated **Google Gemini AI** to provide automated, high-level summaries.

### Automated Analysis Workflow
1. **Filtering:** My script extracts only high-risk events (C2 IPs, suspicious file mutations) from the raw JSON data.
2. **Contextual Prompting:** The filtered data is fed to Gemini with a security-focused instruction set.
3. **AI Generation:** The model produces an **Insight Report**, detailing:
    * **Malware Intent:** What is the software trying to achieve? (Exfiltration, Ransom, etc.)
    * **Family Classification:** Potential overlap with known malware families.
    * **Response Strategy:** Immediate steps for incident response.



---
